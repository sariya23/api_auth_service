syntax = "proto3";

package auth;
option go_package = "github.com/sariya23/api_auth_service/gen/auth;auth";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "google/type/date.proto";

service Auth {
  rpc Register(RegisterRequest) returns (RegisterResponse) {
    option (google.api.http) = {
      post: "/v1/auth/register"
      body: "*"
    };
  }
  rpc Login(LoginRequest) returns (LoginResponse) {
    option (google.api.http) = {
      post: "/v1/auth/login"
      body: "*"
    };
  };
  rpc IsAdmin(IsAdminRequest) returns (IsAdminResponse) {
    option (google.api.http) = {
      get: "/v1/auth/is_admin"
    };
  }
  rpc Ping(google.protobuf.Empty) returns (PingResponse) {
    option (google.api.http) = {
      get: "/v1/auth/ping"
    };
  }
  // WEB
  rpc VerifyEmail(VerifyRequest) returns (VerifyResponse) {
    option (google.api.http) = {
      post: "/v1/auth/verify-email"
      body: "*"
    };
  }
  // WEB
  rpc StartVerifyEmailFlow(StartVerifyEmailFlowRequest) returns (StartVerifyEmailFlowResponse) {
    option (google.api.http) = {
      post: "/v1/auth/start-verify-email"
      body: "*"
    };
  }
  // WEB
  rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse) {
    option (google.api.http) = {
      post: "/v1/auth/refresh"
      body: "*"
    };
  }
  // WEB
  rpc Logout(LogoutRequest) returns (LogoutResponse) {
    option (google.api.http) = {
      post: "/v1/auth/logout"
      body: "*"
    };
  }
  // WEB
  rpc GetMe(MeRequest) returns (MeResponse) {
    option (google.api.http) = {
      get: "/v1/auth/me"
    };
  }
  // WEB
  rpc ResetPassword(ResetPasswordRequest) returns (ResetPasswordResponse) {
    option (google.api.http) = {
      post: "/v1/auth/reset-password"
      body: "*"
    };
  }

  // WEB
  rpc ResetPasswordConfirm(ResetPasswordConfirmRequest) returns (ResetPasswordConfirmResponse) {
    option (google.api.http) = {
      get: "/v1/auth/reset-password-confirm"
    };
  }

  // WEB
  rpc ResetPasswordConfirmSetNew(ResetPasswordConfirmSetNewRequest) returns (ResetPasswordConfirmSetNewResponse) {
    option (google.api.http) = {
      post: "/v1/auth/reset-password-set"
      body: "*"
    };
  }
}

message PingResponse {
  string response = 1;
}

message RegisterRequest {
  string email = 1;
  string password = 2;
}

message RegisterResponse {
  string user_id = 1;
}

message LoginRequest {
  string email = 1;
  string password = 2;
}

message LoginResponse {
  reserved 1;

}

message IsAdminRequest {
  string user_id = 1;
}

message IsAdminResponse {
  bool is_admin = 1;
}

message VerifyRequest {
  string code = 1;
}

message VerifyResponse {

}

message StartVerifyEmailFlowRequest {

}

message StartVerifyEmailFlowResponse {

}

message RefreshTokenRequest {

}

message RefreshTokenResponse {
  reserved 1;
}


message LogoutRequest {

}

message LogoutResponse {

}

message MeRequest {

}

message MeResponse {
  User user = 1;
  message User {
    string userID = 1;
    string email = 2;
    bool isVerified = 3;
    google.type.Date createdAt = 4;
    string username = 5;
  }
}

message ResetPasswordRequest {
  string email = 1;
}

message ResetPasswordResponse {

}

message ResetPasswordConfirmRequest {
  string token = 1; // query-parameter
}

message ResetPasswordConfirmResponse {

}

message ResetPasswordConfirmSetNewRequest {
  string password = 1;
  string token = 2; // Ð² body
}

message ResetPasswordConfirmSetNewResponse {

}